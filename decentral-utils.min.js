function u8_to_hex(a){return a.reduce(function(a,b){return a+("00"+b.toString(16)).slice(-2)},"")}function hex_to_u8(a){if(0==a.indexOf("0x"))var a=a.replace("0x","");for(var b=new Uint8Array(a.length/2),c=0;c<a.length/2;c++)b[c]=parseInt(""+a[2*c]+a[2*c+1],16);return b}if("object"==typeof TextEncoder){var utf8encoder=new TextEncoder("utf8"),utf8decoder=new TextDecoder("utf8")}else{}function make_struct(a){var b=Math.max,c=Math.floor,d={},a=a||{},e=a.v||"";if(e instanceof Uint8Array)d.v=e;else if("string"==typeof e)d.v=utf8_to_u8(e.toString());else if(e.length)d.v=Uint8Array.from(e);else throw"struct.v must be a string or byte-array in make_struct()";return d.seq=isNaN(a.seq)?1:b(c(a.seq),1),a.salt&&(d.salt=a.salt.substr(0,64)),a.cas&&!isNaN(a.cas)&&(d.cas=a.cas),a.k&&(d.k=a.k),a.sig&&(d.sig=a.sig),d}function make_sig_check(a){var a=make_struct(a),b=(a.salt?"4:salt"+utf8_to_u8(a.salt).length+":"+a.salt:"")+"3:seqi"+a.seq+"e1:v"+a.v.length+":",c=utf8_to_u8(b).length,d=new Uint8Array(c+a.v.length);return d.set(utf8_to_u8(b)),d.set(a.v,c),d}function freshest(a,b,c){var d=Math.round,a=make_struct(a),e=b,b=make_struct(b);return isNaN(b.seq)?a:d(b.seq)==b.seq?0>=b.seq?a:b.seq<(a?a.seq:1)?a:null!=b.cas&&b.cas!=(a?a.seq:1)?a:1e3<b.v.length?a:64<b.salt?a:c(make_sig_check(b),b.sig,b.k)?e:a:a}module.exports={u8_to_hex:u8_to_hex,hex_to_u8:hex_to_u8,u8_to_utf8:u8_to_utf8,utf8_to_u8:utf8_to_u8,make_sig_check:make_sig_check,make_struct:make_struct,freshest:freshest};